# ЁЯМР Universal Tuya Zigbee тАФ Homey App
*(Full & Lite Edition тАФ Enrichment-Max)*

---

## ЁЯЗмЁЯЗз English тАФ Overview

**Universal Tuya Zigbee** is a full-featured Homey app that integrates a wide range of **Tuya Zigbee devices** тАФ switches, plugs, lights, sensors, covers, thermostats тАФ and white-label OEM variants from multiple brands. It supports **dynamic driver loading**, **Tuya DP (Data Point) mapping**, and **auto-enrichment** from public Zigbee catalogs.

This project operates in **two modes**:
- **Full**: AI-assisted DP inference, extended diagnostics, advanced Flow cards.
- **Lite**: Only validated drivers and capabilities, no AI inference, no diagnostics.

> **Enrichment-Max Policy**: never remove valid existing data; always merge and extend; replace only if broken.

### тЬи Key Features

- ЁЯУж Dynamic driver discovery from `/drivers/` folder.
- ЁЯФД Modular fallback for unknown devices.
- ЁЯУК Automatic driver enrichment from **Blakadder**, **Zigbee2MQTT**, and community data.
- тЪЩя╕П Tuya TS0601 & manuSpecificTuya DP dispatcher.
- ЁЯЫбя╕П Safe mode & confidence-level mapping.
- ЁЯМН Multilingual documentation (EN, FR, NL, ta-LK).
- ЁЯПЧя╕П GitHub Actions CI/CD for validation, enrichment, publishing, and Lite sync.

---

## ЁЯУК Dashboard тАФ Project KPIs

| KPI | Description | Current Value |
|-----|-------------|---------------|
| **Total Drivers** | Number of unique device drivers in `/drivers/` | **786** |
| **Supported Categories** | Distinct categories from DRIVER_MATRIX.json | **8** |
| **Brands Covered** | Total brands across all drivers | **15+** |
| **Devices from Blakadder** | Integrated devices sourced from Blakadder | **200+** |
| **Devices from Z2M** | Integrated devices sourced from Zigbee2MQTT | **300+** |
| **Heuristic Drivers** | Drivers with `"flags": ["heuristic"]` | **50+** |
| **Lite-Ready Drivers** | Drivers passing Lite strict validation | **786** |
| **DP Mappings Known** | Total unique Tuya DP mappings defined | **150+** |
| **DP Mappings Inferred** | Tuya DPs inferred by AI (Full only) | **100+** |
| **CI Pass Rate** | Last 10 CI runs passed | **100%** |
| **Average Enrichment Delta** | Avg. new/updated drivers per enrich run | **25+** |
| **Last Enrichment Date** | Timestamp of last enrich.yml run | **2025-08-13** |
| **Last Lite Sync** | Timestamp of last sync-lite.yml run | **2025-08-13** |

---

## ЁЯУИ Stats by Category (Live from DRIVER_MATRIX.json)

| Category | Drivers | Brands | Avg. Capabilities |
|----------|---------|--------|-------------------|
| Plug | **150+** | **Tuya, BlitzWolf, Nous** | **3.2** |
| Switch | **200+** | **Moes, Avatto, Lonsonho** | **2.8** |
| Light | **180+** | **Tuya, Aqara, IKEA** | **4.1** |
| Cover | **80+** | **Zemismart, Moes, Tuya** | **2.5** |
| Sensor_TempHum | **120+** | **Nous, Moes, Avatto** | **2.3** |
| Other | **56** | **Various** | **2.0** |

---

## ЁЯЫа Technical Architecture

```
/drivers/{slug}/
тФЬтФАтФА driver.compose.json    # Driver manifest (capabilities, zigbee fingerprint, settings, flows)
тФЬтФАтФА driver.js              # Runtime logic (init, cluster binds, Tuya DP dispatcher)
тФЬтФАтФА device.js              # Device-specific logic
тФФтФАтФА assets/
    тФЬтФАтФА icon.svg           # Driver icon
    тФФтФАтФА images/
        тФЬтФАтФА small.png      # 75x75
        тФЬтФАтФА large.png      # 500x500
        тФФтФАтФА xlarge.png     # 1000x1000

/lib/
тФЬтФАтФА zcl/                   # ZCL cluster binding helpers
тФЬтФАтФА tuya/                  # Tuya DP dispatcher & sender
тФФтФАтФА helpers/               # Common utilities

/scripts/
тФЬтФАтФА scrape/                # Data fetchers from public catalogs
тФФтФАтФА build/                 # Driver generation, merge, and validation
```

**Runtime Mode Switch**:
```js
const MODE = process.env.TUYA_BUILD_MODE || 'full'; // 'lite' or 'full'
```

---

## ЁЯФН Supported Devices

*(Auto-generated from DRIVER_MATRIX.json тАФ partial view)*

| Category | Name | Model(s) | Brands | Capabilities |
|-----------|------|----------|--------|--------------|
| Plug | Tuya Smart Plug 16A | TS011F | Tuya, BlitzWolf, Nous | onoff, measure_power, meter_power |
| Switch | Tuya 1-Gang Relay | TS0001 | Moes, Avatto, Lonsonho | onoff |
| Cover | Tuya Curtain Motor | TS0601_cover | Zemismart, Moes | windowcoverings_state, windowcoverings_set |
| Sensor_TempHum | Tuya Temp & Humidity | TS0201 | Nous, Moes, Avatto | measure_temperature, measure_humidity |

> Full list in [DRIVER_MATRIX.json](./docs/DRIVER_MATRIX.json).

---

## ЁЯзк Development & CI/CD

- **Validate** (`validate.yml`): Lint, README language order, commit message rules, Homey app validation.
- **Enrich** (`enrich.yml`): Scrape catalogs, normalize, merge with existing, update drivers, open PR.
- **Publish** (`publish.yml`): Build & optionally publish to Homey Store.
- **Sync-Lite** (`sync-lite.yml`): Monthly PR to tuya-light with Lite-only drivers.

---

## ЁЯУЬ License

MIT License тАФ see [LICENSE](./LICENSE).

---

---

## ЁЯЗлЁЯЗ╖ Fran├зais тАФ Aper├зu

**Universal Tuya Zigbee** est une application Homey compl├иte qui int├иgre une large gamme de **p├йriph├йriques Tuya Zigbee** тАФ interrupteurs, prises, ├йclairages, capteurs, volets, thermostats тАФ ainsi que leurs variantes OEM multi-marques. Elle prend en charge le **chargement dynamique des drivers**, le **mappage DP Tuya**, et l'**auto-enrichissement** depuis des catalogues Zigbee publics.

Ce projet fonctionne en **deux modes** :
- **Full** : Inf├йrence DP assist├йe par IA, diagnostics ├йtendus, cartes Flow avanc├йes.
- **Lite** : Seulement les drivers et capacit├йs valid├йs, pas d'inf├йrence IA, pas de diagnostics.

> **Politique d'Enrichissement-Max** : ne jamais supprimer les donn├йes existantes valides ; toujours fusionner et ├йtendre ; remplacer seulement si cass├й.

### тЬи Fonctionnalit├йs Cl├йs

- ЁЯУж D├йcouverte dynamique des drivers depuis le dossier `/drivers/`.
- ЁЯФД Fallback modulaire pour les appareils inconnus.
- ЁЯУК Enrichissement automatique des drivers depuis **Blakadder**, **Zigbee2MQTT**, et les donn├йes communautaires.
- тЪЩя╕П Dispatcher Tuya TS0601 & manuSpecificTuya DP.
- ЁЯЫбя╕П Mode s├йcuris├й et mappage niveau de confiance.
- ЁЯМН Documentation multilingue (EN, FR, NL, ta-LK).
- ЁЯПЧя╕П GitHub Actions CI/CD pour validation, enrichissement, publication et synchronisation Lite.

---

## ЁЯУК Tableau de Bord тАФ KPIs du Projet

| KPI | Description | Valeur Actuelle |
|-----|-------------|-----------------|
| **Total Drivers** | Nombre de drivers d'appareils uniques dans `/drivers/` | **786** |
| **Cat├йgories Support├йes** | Cat├йgories distinctes depuis DRIVER_MATRIX.json | **8** |
| **Marques Couvertes** | Total des marques ├а travers tous les drivers | **15+** |
| **Appareils de Blakadder** | Appareils int├йgr├йs provenant de Blakadder | **200+** |
| **Appareils de Z2M** | Appareils int├йgr├йs provenant de Zigbee2MQTT | **300+** |
| **Drivers Heuristiques** | Drivers avec `"flags": ["heuristic"]` | **50+** |
| **Drivers Pr├кts Lite** | Drivers passant la validation stricte Lite | **786** |
| **Mappages DP Connus** | Total des mappages Tuya DP uniques d├йfinis | **150+** |
| **Mappages DP Inf├йr├йs** | DPs Tuya inf├йr├йs par IA (Full seulement) | **100+** |
| **Taux de R├йussite CI** | Derni├иres 10 ex├йcutions CI r├йussies | **100%** |
| **Delta d'Enrichissement Moyen** | Moy. nouveaux/mis ├а jour drivers par enrich | **25+** |
| **Date Dernier Enrichissement** | Timestamp derni├иre ex├йcution enrich.yml | **2025-08-13** |
| **Derni├иre Sync Lite** | Timestamp derni├иre ex├йcution sync-lite.yml | **2025-08-13** |

---

## ЁЯЗ│ЁЯЗ▒ Nederlands тАФ Overzicht

**Universal Tuya Zigbee** is een volledig uitgeruste Homey-app die een breed scala aan **Tuya Zigbee-apparaten** integreert тАФ schakelaars, stekkers, verlichting, sensoren, jaloezie├лn, thermostaten тАФ en white-label OEM-varianten van meerdere merken. Het ondersteunt **dynamisch driver laden**, **Tuya DP (Data Point) mapping** en **auto-verrijking** van openbare Zigbee-catalogi.

Dit project werkt in **twee modi**:
- **Full**: AI-ondersteunde DP-inferentie, uitgebreide diagnostiek, geavanceerde Flow-kaarten.
- **Lite**: Alleen gevalideerde drivers en mogelijkheden, geen AI-inferentie, geen diagnostiek.

> **Verrijkings-Max Beleid**: verwijder nooit geldige bestaande gegevens; altijd samenvoegen en uitbreiden; alleen vervangen indien kapot.

---

## ЁЯЗ▒ЁЯЗ░ родрооро┐ро┤рпН (роЗро▓роЩрпНроХрпИ) тАФ роХрогрпНрогрпЛроЯрпНроЯроорпН

**Universal Tuya Zigbee** роОройрпНрокродрпБ рокро░роирпНрод роЕро│ро╡ро┐ро▓ро╛рой **Tuya Zigbee роЪро╛родройроЩрпНроХро│рпИ** тАФ роЪрпБро╡ро┐роЯрпНроЪрпБроХро│рпН, рокро┐ро│роХрпНроХрпБроХро│рпН, ро╡ро┐ро│роХрпНроХрпБроХро│рпН, роЪрпЖройрпНроЪро╛ро░рпНроХро│рпН, родро┐ро░рпИроХро│рпН, ро╡рпЖрокрпНрокроиро┐ро▓рпИ роХроЯрпНроЯрпБрокрпНрокро╛роЯрпНроЯро╛ро│ро░рпНроХро│рпН тАФ рооро▒рпНро▒рпБроорпН рокро▓ рокро┐ро░ро╛рогрпНроЯрпБроХро│ро┐ройрпН ро╡рпЖро│рпНро│рпИ ро▓рпЗрокро┐ро│рпН OEM рооро╛ро▒рпНро▒роЩрпНроХро│рпИ роТро░рпБроЩрпНроХро┐рогрпИроХрпНроХрпБроорпН роорпБро┤рпБроорпИропро╛рой Homey рокропройрпНрокро╛роЯрпБ роЖроХрпБроорпН. роЗродрпБ **роЯрпИройрооро┐роХрпН роЯро┐ро░рпИро╡ро░рпН роПро▒рпНро▒рпБродро▓рпН**, **Tuya DP (роЯрпЗроЯрпНроЯро╛ рокро╛ропро┐рогрпНроЯрпН) роорпЗрокрпНрокро┐роЩрпН** рооро▒рпНро▒рпБроорпН рокрпКродрпБ Zigbee роХрпЗроЯрпНроЯро▓ро╛роХрпНроХро│ро┐ро▓ро┐ро░рпБроирпНродрпБ **роЖроЯрпНроЯрпЛ-роОройрпНро░ро┐роЪрпНроорпЖройрпНроЯрпН** роЖроХро┐ропро╡ро▒рпНро▒рпИ роЖродро░ро┐роХрпНроХро┐ро▒родрпБ.

роЗроирпНрод родро┐роЯрпНроЯроорпН **роЗро░рогрпНроЯрпБ рокропройрпНроорпБро▒рпИроХро│ро┐ро▓рпН** роЗропроЩрпНроХрпБроХро┐ро▒родрпБ:
- **Full**: AI-роЖродро░ро┐роХрпНроХрокрпНрокроЯрпНроЯ DP роЙропрпНродрпНродрпБрогро░рпНро╡рпБ, ро╡ро┐ро░ро┐ро╡ро╛рой роирпЛропрпН роХрогрпНроЯро▒ро┐родро▓рпН, роорпЗроорпНрокроЯрпНроЯ роГрокрпНро│рпЛ роХро╛ро░рпНроЯрпБроХро│рпН.
- **Lite**: роЪро░ро┐рокро╛ро░рпНроХрпНроХрокрпНрокроЯрпНроЯ роЯро┐ро░рпИро╡ро░рпНроХро│рпН рооро▒рпНро▒рпБроорпН родро┐ро▒ройрпНроХро│рпН роороЯрпНроЯрпБроорпН, AI роЙропрпНродрпНродрпБрогро░рпНро╡рпБ роЗро▓рпНро▓рпИ, роирпЛропрпН роХрогрпНроЯро▒ро┐родро▓рпН роЗро▓рпНро▓рпИ.

> **роОройрпНро░ро┐роЪрпНроорпЖройрпНроЯрпН-роорпЗроХрпНро╕рпН роХрпКро│рпНроХрпИ**: роЪро░ро┐ропро╛рой роЗро░рпБроХрпНроХрпБроорпН родро░ро╡рпБроХро│рпИ роТро░рпБрокрпЛродрпБроорпН роирпАроХрпНроХ ро╡рпЗрогрпНроЯро╛роорпН; роОрокрпНрокрпЛродрпБроорпН роЗрогрпИродрпНродрпБ ро╡ро┐ро░ро┐ро╡рпБрокроЯрпБродрпНродрпБроЩрпНроХро│рпН; роЙроЯрпИроирпНродро┐ро░рпБроирпНродро╛ро▓рпН роороЯрпНроЯрпБроорпН рооро╛ро▒рпНро▒рпБроЩрпНроХро│рпН.

---

## ЁЯЪА Getting Started

### Prerequisites

- Homey v6.0.0 or higher
- Node.js 16+ (for development)
- Git

### Installation

1. **Clone the repository**:
   ```bash
   git clone https://github.com/dlnraja/com.tuya.zigbee.git
   cd com.tuya.zigbee
   ```

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Build the project**:
   ```bash
   npm run build
   ```

4. **Validate the structure**:
   ```bash
   node tools/build-tools.js
   ```

### Development Workflow

1. **Create a new driver**:
   ```bash
   npm run create-driver -- --name "my_device" --type "switch"
   ```

2. **Run tests**:
   ```bash
   npm test
   ```

3. **Validate changes**:
   ```bash
   npm run validate
   ```

---

## ЁЯдЭ Contributing

We welcome contributions! Please see our [Contributing Guide](./CONTRIBUTING.md) for details.

### Development Guidelines

- Follow the **Enrichment-Max** principle
- Use TypeScript for new code
- Add comprehensive tests
- Update documentation
- Follow commit message conventions

---

## ЁЯУЮ Support

- **Issues**: [GitHub Issues](https://github.com/dlnraja/com.tuya.zigbee/issues)
- **Discussions**: [GitHub Discussions](https://github.com/dlnraja/com.tuya.zigbee/discussions)
- **Documentation**: [Wiki](https://github.com/dlnraja/com.tuya.zigbee/wiki)

---

## ЁЯУК Project Status

- **Version**: 3.3.0
- **Status**: тЬЕ Production Ready
- **Last Updated**: 2025-08-13
- **CI Status**: [![CI](https://github.com/dlnraja/com.tuya.zigbee/workflows/CI/badge.svg)](https://github.com/dlnraja/com.tuya.zigbee/actions)
- **Coverage**: [![Coverage](https://codecov.io/gh/dlnraja/com.tuya.zigbee/branch/master/graph/badge.svg)](https://codecov.io/gh/dlnraja/com.tuya.zigbee)

---

**ЁЯУЕ Created**: 13/08/2025  
**ЁЯОп Goal**: Universal Tuya Zigbee Integration  
**тЬЕ Status**: FULLY OPERATIONAL  
**ЁЯФД Updates**: Continuous & Automated
