name: ðŸ”„ Sync tuya-light from master

on:
  schedule:
    - cron: '0 4 1 * *' # chaque 1er du mois Ã  04:00 UTC
  workflow_dispatch:

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Configure Git
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"

      - name: Sync master âž” tuya-light
        run: |
          git fetch origin
          git checkout tuya-light
          git merge origin/master --strategy=ours -m "ðŸ”„ Monthly sync from master"
          git push origin tuya-light

      - name: Create sync notification
        uses: actions/github-script@v6
        with:
          script: |
            github.rest.issues.create({
              owner: context.repo.owner,
              repo: context.repo.repo,
              title: 'ðŸ”„ Monthly Sync Completed',
              body: `âœ… Synchronisation mensuelle master â†’ tuya-light terminÃ©e!
              
              ðŸ“… **Date**: ${new Date().toISOString()}
              ðŸ”„ **Type**: Sync automatique mensuel
              ðŸ“Š **Statut**: SuccÃ¨s
              
              ðŸŽ¯ **MEGA-PROMPT ULTIME - VERSION FINALE 2025**`
            }) 