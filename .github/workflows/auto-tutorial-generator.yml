# üöÄ Auto-Tutorial Generator - Tuya Zigbee Project
# G√©n√©ration automatique de tutoriels pour les drivers

name: üìö Auto-Tutorial Generator

on:
  push:
    paths:
      - 'drivers/**'
      - 'README.md'
  workflow_dispatch:
  schedule:
    - cron: '0 3 * * *'  # Tous les jours √† 3h00 UTC

jobs:
  generate-tutorials:
    runs-on: ubuntu-latest
    name: üìö G√©n√©ration automatique de tutoriels
    
    steps:
      - name: üì• Checkout repository
        uses: actions/checkout@v4
        
      - name: üîß Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          
      - name: üì¶ Install dependencies
        run: |
          npm install
          npm install -g markdown-it
          
      - name: üîç Generate tutorials
        run: |
          echo "Generating tutorials for drivers..."
          mkdir -p docs/tutorials
          
          # Cr√©er un script simple pour g√©n√©rer les tutoriels
          cat > generate_tutorials.js << 'EOF'
          const fs = require('fs');
          const path = require('path');
          
          const drivers = ['curtain_module', 'rain_sensor', 'multi_sensor', 'smart_plug', 'remote_control'];
          
          drivers.forEach(driver => {
            const tutorialContent = `# üìö Tutoriel - ${driver}
          
          ## üéØ Vue d'ensemble
          Ce tutoriel vous guide dans l'installation et la configuration du driver **${driver}** pour Homey.
          
          ## üìã Pr√©requis
          - Homey avec firmware 8.0+
          - Application Tuya Zigbee install√©e
          - Appareil compatible ${driver}
          
          ## üîß Installation
          
          ### √âtape 1: Ajout du driver
          1. Ouvrez l'application Tuya Zigbee sur Homey
          2. Allez dans l'onglet "Drivers"
          3. Recherchez "${driver}"
          4. Cliquez sur "Installer"
          
          ### √âtape 2: Configuration
          1. Appuyez sur le bouton "+" pour ajouter un appareil
          2. S√©lectionnez "${driver}" dans la liste
          3. Suivez les instructions √† l'√©cran
          
          ## ‚öôÔ∏è Configuration avanc√©e
          
          ### Param√®tres recommand√©s
          - **Polling interval**: 60 secondes
          - **Battery threshold**: 20%
          - **Auto-reconnect**: Activ√©
          
          ### D√©pannage
          - **Probl√®me**: L'appareil ne se connecte pas
            - **Solution**: V√©rifiez que l'appareil est en mode pairing
          - **Probl√®me**: Batterie faible
            - **Solution**: Remplacez les piles et recalibrez
          
          ## üìä Monitoring
          - Surveillez la batterie dans l'application
          - V√©rifiez les logs pour les erreurs
          - Utilisez le dashboard pour les statistiques
          
          ## üîó Liens utiles
          - [Documentation officielle](../README.md)
          - [Support communautaire](https://github.com/dlnraja/com.tuya.zigbee/issues)
          - [Dashboard temps r√©el](../dashboard/)
          
          ---
          *G√©n√©r√© automatiquement le ${new Date().toISOString()}*
          `;
          
            fs.writeFileSync(`docs/tutorials/${driver}_tutorial.md`, tutorialContent);
            console.log(`Generated tutorial for ${driver}`);
          });
          
          // G√©n√©rer le guide d'installation
          const installationGuide = `# üöÄ Guide d'Installation - Tuya Zigbee
          
          ## üìã Pr√©requis syst√®me
          - Homey avec firmware 8.0+
          - Connexion internet stable
          - Compte Tuya (optionnel)
          
          ## üîß Installation √©tape par √©tape
          
          ### 1. Installation de l'application
          1. Ouvrez l'App Store sur Homey
          2. Recherchez "Tuya Zigbee"
          3. Cliquez sur "Installer"
          4. Attendez la fin de l'installation
          
          ### 2. Configuration initiale
          1. Ouvrez l'application Tuya Zigbee
          2. Acceptez les conditions d'utilisation
          3. Configurez votre r√©gion
          4. Testez la connexion
          
          ### 3. Ajout d'appareils
          1. Appuyez sur "+" pour ajouter un appareil
          2. S√©lectionnez le type d'appareil
          3. Suivez les instructions de pairing
          4. Configurez les param√®tres
          
          ## ‚öôÔ∏è Configuration avanc√©e
          
          ### Param√®tres r√©seau
          - **Zigbee Channel**: Auto-d√©tection
          - **Security**: WPA2 recommand√©
          - **Range**: Jusqu'√† 100m en ext√©rieur
          
          ### Optimisation des performances
          - Placez le Homey au centre de votre installation
          - √âvitez les interf√©rences WiFi
          - Utilisez des r√©p√©teurs si n√©cessaire
          
          ## üîç D√©pannage
          
          ### Probl√®mes courants
          1. **Appareil non d√©tect√©**
             - V√©rifiez le mode pairing
             - Red√©marrez l'appareil
             - V√©rifiez la distance
          
          2. **Connexion instable**
             - V√©rifiez la batterie
             - D√©placez l'appareil plus pr√®s
             - Ajoutez un r√©p√©teur
          
          3. **Erreurs de mise √† jour**
             - V√©rifiez la connexion internet
             - Red√©marrez Homey
             - Contactez le support
          
          ## üìû Support
          - **Documentation**: [README.md](../README.md)
          - **Issues**: [GitHub](https://github.com/dlnraja/com.tuya.zigbee/issues)
          - **Dashboard**: [Temps r√©el](../dashboard/)
          
          ---
          *G√©n√©r√© automatiquement le ${new Date().toISOString()}*
          `;
          
          fs.writeFileSync('docs/INSTALLATION_GUIDE.md', installationGuide);
          console.log('Generated installation guide');
          
          // G√©n√©rer le guide de d√©pannage
          const troubleshootingGuide = `# üîß Guide de D√©pannage - Tuya Zigbee
          
          ## üö® Probl√®mes courants et solutions
          
          ### 1. Appareil non d√©tect√©
          **Sympt√¥mes**: L'appareil n'appara√Æt pas dans la liste
          **Solutions**:
          - V√©rifiez que l'appareil est en mode pairing
          - Red√©marrez l'appareil
          - V√©rifiez la distance (max 10m)
          - Changez les piles si n√©cessaire
          
          ### 2. Connexion instable
          **Sympt√¥mes**: L'appareil se d√©connecte r√©guli√®rement
          **Solutions**:
          - D√©placez l'appareil plus pr√®s du Homey
          - Ajoutez un r√©p√©teur Zigbee
          - V√©rifiez les interf√©rences WiFi
          - Mettez √† jour le firmware
          
          ### 3. Batterie faible
          **Sympt√¥mes**: Alertes de batterie fr√©quentes
          **Solutions**:
          - Remplacez les piles
          - V√©rifiez la qualit√© des piles
          - R√©duisez la fr√©quence de polling
          - Recalibrez le capteur
          
          ### 4. Erreurs de mise √† jour
          **Sympt√¥mes**: √âchec des mises √† jour
          **Solutions**:
          - V√©rifiez la connexion internet
          - Red√©marrez Homey
          - V√©rifiez l'espace disque
          - Contactez le support
          
          ## üìä Diagnostic
          
          ### Logs utiles
          - **Application logs**: Settings > System > Logs
          - **Driver logs**: Dans l'application Tuya Zigbee
          - **Network logs**: Pour les probl√®mes de connexion
          
          ### Outils de diagnostic
          - **Dashboard**: Monitoring temps r√©el
          - **Terminal**: Scripts PowerShell de diagnostic
          - **API**: Endpoints de diagnostic
          
          ## üÜò Support avanc√©
          
          ### Informations √† fournir
          1. Version de Homey
          2. Version de l'application
          3. Type d'appareil
          4. Logs d'erreur
          5. √âtapes de reproduction
          
          ### Contacts
          - **GitHub Issues**: [Lien](https://github.com/dlnraja/com.tuya.zigbee/issues)
          - **Documentation**: [README.md](../README.md)
          - **Dashboard**: [Monitoring](../dashboard/)
          
          ---
          *G√©n√©r√© automatiquement le ${new Date().toISOString()}*
          `;
          
          fs.writeFileSync('docs/TROUBLESHOOTING.md', troubleshootingGuide);
          console.log('Generated troubleshooting guide');
          EOF
          
          node generate_tutorials.js
          
      - name: üìù Commit tutorials
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/
          git commit -m "üìö [$(date -u '+%Y-%m-%d %H:%M UTC')] Auto-tutorials: Guides g√©n√©r√©s pour 5 drivers + guides installation/d√©pannage. Powered by GitHub Actions"
          git push
          
      - name: üìà Update tutorial stats
        run: |
          echo "Tutorials generated successfully!"
          echo "Files created:"
          echo "- 5 driver tutorials"
          echo "- Installation guide"
          echo "- Troubleshooting guide"
          echo "Next update: Tomorrow 3:00 UTC" 