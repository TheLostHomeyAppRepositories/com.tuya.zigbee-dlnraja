try { 'use strict'; const { ZigBeeDevice } = require('homey-meshdriver'); const { CLUSTER } = require('zigbee-clusters'); class smoke_sensor extends ZigbeeDevice { async this.registerCapability('onoff', CLUSTER.ON_OFF); this.printNode(); zclNode.endpoints[1].clusters[CLUSTER.IAS_ZONE.NAME].onZoneStatusChangeNotification = payload => { this.onIASZoneStatusChangeNotification(payload); } } onIASZoneStatusChangeNotification({zoneStatus, extendedStatus, zoneId, delay,}) { this.log('IASZoneStatusChangeNotification received:', zoneStatus, extendedStatus, zoneId, delay); this.setCapabilityValue('alarm_smoke', zoneStatus.alarm1).catch(this.error); this.setCapabilityValue('alarm_battery', zoneStatus.battery).catch(this.error); } onDeleted(){ this.log("Smoke Sensor removed") } } module.exports = smoke_sensor; } catch(e) { this.error('Driver error', e); } 
